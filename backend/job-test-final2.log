
> backend@1.0.0 test
> cross-env NODE_ENV=test NODE_OPTIONS=--experimental-vm-modules jest --runInBand jobs.test.js

  console.log
    [dotenv@17.2.3] injecting env (8) from .env.test -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    â­  Skipping DB connection in test mode

      at log (config/db.js:8:13)

(node:17568) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
  console.log
    âœ… Test database connected

      at Object.log (__tests__/setup.js:17:13)

  console.log
    âœ… Test database disconnected

      at Object.log (__tests__/setup.js:39:11)

FAIL __tests__/jobs.test.js (10.507 s)
  Job API
    POST /api/jobs
      âˆš should create a job by employer with company (818 ms)
      âˆš should reject job creation by jobseeker (416 ms)
      Ã— should reject job creation without company (448 ms)
    GET /api/jobs
      âˆš should get all active jobs (693 ms)
      âˆš should filter jobs by location (773 ms)
      âˆš should filter jobs by job type (678 ms)
    GET /api/jobs/:id
      âˆš should get single job by ID (538 ms)
      âˆš should return 404 for non-existent job (280 ms)
    PUT /api/jobs/:id
      âˆš should update own job (653 ms)
      âˆš should reject update of other user's job (784 ms)
    DELETE /api/jobs/:id
      âˆš should delete own job (soft delete) (635 ms)
      âˆš should reject deletion of other user's job (739 ms)
    PATCH /api/jobs/:id/close
      âˆš should close/reopen job (636 ms)
      âˆš should reject closing already closed job (624 ms)

  â— Job API â€º POST /api/jobs â€º should reject job creation without company

    TypeError: expect(received).toMatch(expected)

    Matcher error: received value must be a string

    Received has value: undefined

    [0m [90m 75 |[39m
     [90m 76 |[39m       expect(res[33m.[39mstatusCode)[33m.[39mtoBe([35m400[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 77 |[39m       expect(res[33m.[39mbody[33m.[39mmessage)[33m.[39mtoMatch([35m/company profile first/i[39m)[33m;[39m
     [90m    |[39m                                [31m[1m^[22m[39m
     [90m 78 |[39m     })[33m;[39m
     [90m 79 |[39m   })[33m;[39m
     [90m 80 |[39m[0m

      at Object.toMatch (__tests__/jobs.test.js:77:32)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 13 passed, 14 total
Snapshots:   0 total
Time:        10.566 s, estimated 12 s
Ran all test suites matching jobs.test.js.
