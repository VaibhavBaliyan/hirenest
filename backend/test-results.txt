
> backend@1.0.0 test
> cross-env NODE_ENV=test NODE_OPTIONS=--experimental-vm-modules jest --runInBand

  console.log
    [dotenv@17.2.3] injecting env (8) from .env.test -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.error
    ‚ùå Test database connection failed: MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections
        at NativeConnection.createClient (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\mongoose\lib\drivers\node-mongodb-native\connection.js:244:13)
        at NativeConnection.openUri (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\mongoose\lib\connection.js:1075:34)
        at Mongoose.connect (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\mongoose\lib\mongoose.js:451:15)
        at Object.connect (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\__tests__\setup.js:16:20)
        at Promise.finally.completed (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusHook (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\jestAdapterInit.js:976:40)
        at _runTestsForDescribeBlock (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\jestAdapterInit.js:800:7)
        at run (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-runner\build\index.js:275:16)
        at runTest (C:\Users\Vaibhav\Desktop\My Projects\hirenest\backend\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 20 |[39m     [36mthrow[39m error[33m;[39m
     [90m 21 |[39m   }
     [90m 22 |[39m })[33m;[39m[0m

      at Object.error (__tests__/setup.js:19:13)

  console.log
    ‚úÖ Test database disconnected

      at Object.log (__tests__/setup.js:39:11)

(node:6220) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL __tests__/auth.test.js
  Authentication API
    POST /api/auth/register
      √ó should register a new user with valid data (1 ms)
      √ó should register an employer user
      √ó should reject duplicate email
      √ó should reject weak password (less than 6 characters)
      √ó should reject invalid email format
      √ó should reject missing required fields
      √ó should reject invalid role
    POST /api/auth/login
      √ó should login with valid credentials
      √ó should reject invalid email
      √ó should reject invalid password (1 ms)
      √ó should reject missing email
      √ó should reject missing password
    GET /api/auth/me
      √ó should return current user with valid token
      √ó should reject request without token
      √ó should reject request with invalid token format (1 ms)
      √ó should reject expired token
      √ó should reject token without Bearer prefix (1 ms)
      √ó should reject token for deleted user
    Token Security
      √ó should generate unique tokens for different users
      √ó should hash passwords before storing

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should register a new user with valid data

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should register an employer user

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should reject duplicate email

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should reject weak password (less than 6 characters)

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should reject invalid email format

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should reject missing required fields

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/register ‚Ä∫ should reject invalid role

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/login ‚Ä∫ should login with valid credentials

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/login ‚Ä∫ should reject invalid email

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/login ‚Ä∫ should reject invalid password

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/login ‚Ä∫ should reject missing email

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ POST /api/auth/login ‚Ä∫ should reject missing password

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ GET /api/auth/me ‚Ä∫ should return current user with valid token

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ GET /api/auth/me ‚Ä∫ should reject request without token

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ GET /api/auth/me ‚Ä∫ should reject request with invalid token format

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ GET /api/auth/me ‚Ä∫ should reject expired token

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ GET /api/auth/me ‚Ä∫ should reject token without Bearer prefix

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ GET /api/auth/me ‚Ä∫ should reject token for deleted user

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ Token Security ‚Ä∫ should generate unique tokens for different users

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

  ‚óè Authentication API ‚Ä∫ Token Security ‚Ä∫ should hash passwords before storing

    MongooseError: Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections

    [0m [90m 14 |[39m       [32m"mongodb://localhost:27017/hirenest_test"[39m[33m;[39m
     [90m 15 |[39m
    [31m[1m>[22m[39m[90m 16 |[39m     [36mawait[39m mongoose[33m.[39mconnect(testMongoUri)[33m;[39m
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 17 |[39m     console[33m.[39mlog([32m"‚úÖ Test database connected"[39m)[33m;[39m
     [90m 18 |[39m   } [36mcatch[39m (error) {
     [90m 19 |[39m     console[33m.[39merror([32m"‚ùå Test database connection failed:"[39m[33m,[39m error)[33m;[39m[0m

      at NativeConnection.createClient (node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js:244:13)
      at NativeConnection.openUri (node_modules/mongoose/lib/connection.js:1075:34)
      at Mongoose.connect (node_modules/mongoose/lib/mongoose.js:451:15)
      at Object.connect (__tests__/setup.js:16:20)

Test Suites: 1 failed, 1 total
Tests:       20 failed, 20 total
Snapshots:   0 total
Time:        1.419 s, estimated 2 s
Ran all test suites.

  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "MongoDB Connected: ac-bflw9wy-shard-00-01.zmbzszz.mongodb.net".

    [0m [90m  6 |[39m   [36mtry[39m {
     [90m  7 |[39m     [36mconst[39m conn [33m=[39m [36mawait[39m mongoose[33m.[39mconnect(process[33m.[39menv[33m.[39m[33mMONGO_URI[39m)[33m;[39m
    [31m[1m>[22m[39m[90m  8 |[39m     console[33m.[39mlog([32m`MongoDB Connected: ${conn.connection.host}`[39m)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m  9 |[39m   } [36mcatch[39m (error) {
     [90m 10 |[39m     console[33m.[39merror([32m`Error: ${error.message}`[39m)[33m;[39m
     [90m 11 |[39m     process[33m.[39mexit([35m1[39m)[33m;[39m[0m

      at console.log (node_modules/@jest/console/build/index.js:311:10)
      at log (config/db.js:8:13)

Jest did not exit one second after the test run has completed.

'This usually means that there are asynchronous operations that weren't stopped in your tests. Consider running Jest with `--detectOpenHandles` to troubleshoot this issue.
